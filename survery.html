<!doctype html>
<html lang="zh-TW">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>問卷</title>
  <link rel="stylesheet" href="assets/app.css" />
  <style>
    .q{margin-top:12px;}
    .q label{display:block; font-size:13px; color:var(--muted); margin-bottom:8px;}
    .opts{display:flex; gap:10px; flex-wrap:wrap;}
    .opt{
      flex:1 1 160px;
      padding:10px 12px;
      border-radius:14px;
      background: rgba(255,255,255,.62);
      border: 1px solid rgba(0,0,0,.08);
      cursor:pointer;
      user-select:none;
    }
    .opt input{margin-right:8px;}
    .actions{display:flex; gap:10px; justify-content:flex-end; margin-top:14px;}
  </style>
</head>
<body>
  <div class="bg-glass"></div>

  <header>
    <div class="brand">
      <div class="logo"></div>
      <div>
        <h1>問卷</h1>
        <p>先填問卷 → 再拍照 → 合併分析</p>
      </div>
    </div>
    <button class="btn" onclick="location.href='index.html'">回首頁</button>
  </header>

  <div class="stage">
    <div class="card">
      <div class="card-head">
        <div>
          <div class="title">拍照前快速問卷（30 秒）</div>
          <div class="sub">用來調整分析權重與建議內容</div>
        </div>
        <span class="tag">必填</span>
      </div>

      <div class="body">
        <form id="surveyForm">
          <div class="q">
            <label>1) 你的膚質偏向？</label>
            <div class="opts">
              <label class="opt"><input type="radio" name="skinType" value="dry" required>乾性</label>
              <label class="opt"><input type="radio" name="skinType" value="oily" required>油性</label>
              <label class="opt"><input type="radio" name="skinType" value="combo" required>混合</label>
              <label class="opt"><input type="radio" name="skinType" value="normal" required>中性</label>
            </div>
          </div>

          <div class="q">
            <label>2) 今天睡眠狀態？</label>
            <div class="opts">
              <label class="opt"><input type="radio" name="sleep" value="good" required>充足</label>
              <label class="opt"><input type="radio" name="sleep" value="ok" required>普通</label>
              <label class="opt"><input type="radio" name="sleep" value="bad" required>不足</label>
            </div>
          </div>

          <div class="q">
            <label>3) 主要關心項目（可複選）</label>
            <div class="opts">
              <label class="opt"><input type="checkbox" name="concerns" value="acne">痘痘/粉刺</label>
              <label class="opt"><input type="checkbox" name="concerns" value="pores">毛孔</label>
              <label class="opt"><input type="checkbox" name="concerns" value="dull">暗沉</label>
              <label class="opt"><input type="checkbox" name="concerns" value="spots">斑點</label>
              <label class="opt"><input type="checkbox" name="concerns" value="oil">出油</label>
              <label class="opt"><input type="checkbox" name="concerns" value="dry">乾燥</label>
            </div>
          </div>

          <div class="q">
            <label>4) 是否有上妝/濾鏡？</label>
            <div class="opts">
              <label class="opt"><input type="radio" name="makeup" value="no" required>沒有</label>
              <label class="opt"><input type="radio" name="makeup" value="light" required>淡妝</label>
              <label class="opt"><input type="radio" name="makeup" value="heavy" required>濃妝/濾鏡</label>
            </div>
          </div>

          <div class="actions">
            <button type="button" class="btn" onclick="location.href='index.html'">取消</button>
            <button type="submit" class="btn btn-primary">下一步：拍照</button>
          </div>
        </form>
      </div>
    </div>
  </div>

  <div class="toast" id="toast"></div>

  <script type="module">
    import { toast } from "./assets/app.js";

    const form = document.getElementById("surveyForm");

    form.addEventListener("submit", (e) => {
      e.preventDefault();

      const fd = new FormData(form);
      const survey = {
        skinType: fd.get("skinType"),
        sleep: fd.get("sleep"),
        makeup: fd.get("makeup"),
        concerns: fd.getAll("concerns"),
        timestamp: new Date().toISOString()
      };

      // 存在 localStorage，讓 analyze.html 拿得到
      localStorage.setItem("survey", JSON.stringify(survey));

      toast("問卷已保存，準備拍照…");
      setTimeout(() => location.href = "analyze.html", 450);
    });
  </script>
</body>
</html>
