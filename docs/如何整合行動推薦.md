# 如何整合行動推薦系統到 result_new.html

## 📝 簡單 3 步驟整合

### 步驟 1：在 `<head>` 中加入 CSS

在 `result_new.html` 的第 10 行（`<link rel="stylesheet" href="assets/app.css" />` 後面）加入：

```html
<link rel="stylesheet" href="assets/action-recommendations.css" />
```

### 步驟 2：在 A 區詳情頁加入容器

在 `result_new.html` 的第 871 行（「推薦按摩」區塊前）加入：

```html
<!-- 行動推薦 (LLM 偵測結果) -->
<div id="action-recommendations-container">
    <!-- 這裡會動態載入行動推薦卡片 -->
</div>
```

### 步驟 3：在 `</body>` 前加入 JavaScript

在 `result_new.html` 的第 1653 行（`</body>` 前）加入：

```html
<!-- 行動推薦系統 -->
<script src="/js/action-recommendations.js"></script>
<script>
    // 初始化行動推薦系統
    async function initActionRecommendations() {
        try {
            // 初始化管理器
            await actionRecommendationManager.init();
            console.log('✅ 行動推薦系統已初始化');

            // 從 localStorage 或 API 取得 LLM 偵測結果
            const result = loadResult();
            
            // 模擬 LLM 偵測結果（實際應從後端 API 取得）
            const llmDetection = result?.llm_detection || {
                summary: "您的肌膚整體狀況良好，但在以下幾個方面有改善空間。",
                detectedIssues: [1, 4, 5, 10]  // 偵測到的問題 ID
            };

            // 顯示行動推薦
            if (llmDetection.detectedIssues && llmDetection.detectedIssues.length > 0) {
                actionRecommendationManager.displayRecommendations(
                    llmDetection.detectedIssues,
                    '#action-recommendations-container',
                    llmDetection.summary
                );
                console.log('✅ 行動推薦已顯示');
            }
        } catch (error) {
            console.error('❌ 行動推薦系統初始化失敗:', error);
        }
    }

    // 在頁面載入時初始化
    window.addEventListener('DOMContentLoaded', () => {
        initActionRecommendations();
    });
</script>
```

---

## 🎯 完成！

現在當你開啟 `result_new.html` 時，A 區會自動顯示行動推薦卡片。

---

## 🔧 如何修改偵測結果

在步驟 3 的程式碼中，找到這一行：

```javascript
detectedIssues: [1, 4, 5, 10]  // 偵測到的問題 ID
```

修改數字陣列即可改變顯示的行動推薦：
- `[1]` - 只顯示「面部明暗分布」
- `[1, 3, 5]` - 顯示 3 個問題
- `[1, 2, 3, 4, 5, 6, 7, 8, 9, 10]` - 顯示全部 10 個

---

## 📦 實際使用時

當你連接後端 LLM API 時，將這段程式碼：

```javascript
const llmDetection = result?.llm_detection || {
    summary: "您的肌膚整體狀況良好...",
    detectedIssues: [1, 4, 5, 10]
};
```

改成：

```javascript
// 從 API 取得 LLM 偵測結果
const response = await fetch('/api/analyze-photo', {
    method: 'POST',
    body: JSON.stringify({ photo: userPhoto })
});
const llmDetection = await response.json();
```

LLM API 應該回傳這樣的格式：

```json
{
    "summary": "您的肌膚整體狀況良好，但在以下幾個方面有改善空間。",
    "detectedIssues": [1, 4, 5, 10]
}
```
